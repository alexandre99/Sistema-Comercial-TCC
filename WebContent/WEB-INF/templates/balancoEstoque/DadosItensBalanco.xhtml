<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<p:dataTable id="tableItens" reflow="true" var="itens"
		value="#{balancoEstoqueController.listaBalancoEstoqueProdutos}"
		rowIndexVar="linha">

		<p:column headerText="Referência" style="text-align: center;"
			width="100">
			<h:outputText value="#{itens.produto.codigoBarras}"
				rendered="#{not itens.produtoNull}" />

			<p:inputText size="8" value="#{balancoEstoqueController.referencia}"
				label="Referência" id="referencia" rendered="#{itens.produtoNull}">
				<p:ajax event="change" process="@this" update="tableItens"
					listener="#{balancoEstoqueController.setarProdutoNaListaItem}" />
			</p:inputText>
		</p:column>

		<p:column headerText="Descrição" style="text-align: center;"
			width="400">
			<h:outputText value="#{itens.produto.descricao}"
				rendered="#{not itens.produtoNull}" />

			<p:autoComplete id="idProduto" converter="produtoConverter"
				minQueryLength="3" forceSelection="true" maxResults="10"
				value="#{balancoEstoqueController.produto}" var="produto"
				itemLabel="#{produto.descricao}" itemValue="#{produto}"
				completeMethod="#{balancoEstoqueController.autoCompleteProduto}"
				queryDelay="500" rendered="#{itens.produtoNull}"
				onkeyup="strToUpper(this)">

				<p:ajax event="itemSelect" process="@this idProduto"
					update="tableItens"
					listener="#{balancoEstoqueController.setarProdutoNaListaItem}" />

			</p:autoComplete>
		</p:column>

		<p:column headerText="Estoque" style="text-align: center;" width="50">
			<h:outputText value="#{itens.volumeAnterior}">
				<f:convertNumber maxFractionDigits="2" />
			</h:outputText>
		</p:column>

		<p:column headerText="Qtd ajuste" style="text-align: center;"
			width="50">
			<p:inputNumber value="#{itens.volumeAjuste}" maxlength="5"
				label="Quantidade" disabled="#{itens.produtoNull}">
				<p:ajax event="change" process="@this" update="tableItens"
					listener="#{balancoEstoqueController.atualizarQuantidade(itens, linha)}" />
			</p:inputNumber>
		</p:column>
		<p:column headerText="Tipo de ajuste" style="text-align: center;"
			width="200">
			<p:selectOneRadio value="#{itens.tipoBalanco}">
				<f:selectItem itemValue="1" itemLabel="Acres." />
				<f:selectItem itemValue="2" itemLabel="Retirar" />
				<p:ajax event="change" process="@this" update="tableItens"
					listener="#{balancoEstoqueController.atualizarQuantidade(itens, linha)}" />
			</p:selectOneRadio>
		</p:column>

		<p:column headerText="Qtd ajustado" style="text-align: center;"
			width="50">
			<h:outputText value="#{itens.volumeAjustado}" maxlength="5"
				label="Quantidade" disabled="#{itens.produtoNull}" />
		</p:column>

	</p:dataTable>

</ui:composition>